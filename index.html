<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Termo de Compromisso - TDF Pro</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>

  <div class="container" id="formulario-contrato">
    <header>
      <h1>TERMO DE COMPROMISSO DE PARTICIPAÇÃO E PAGAMENTO</h1>
      <h2>PROGRAMA TDF PRO – TRILHA DO FUTEBOL</h2>
    </header>

    <main>
      <form id="meu-formulario">
        <fieldset>
          <legend><strong>Dados do Responsável Legal</strong></legend>
          <p>Eu, <input type="text" id="nome_responsavel" name="nome_responsavel"
              placeholder="Nome completo do responsável" size="50" required>, portador(a) do CPF nº <input type="text"
              id="cpf" name="cpf" placeholder="000.000.000-00" required>, telefone para contato <input type="tel"
              id="telefone" name="telefone" placeholder="(XX) XXXXX-XXXX" required>, na qualidade de pai/mãe ou
            responsável legal pelo(a) atleta:</p>
        </fieldset>
        <fieldset>
          <legend><strong>Dados do Atleta</strong></legend>
          <p><label for="nome_atleta">Nome completo do atleta:</label><br><input type="text" id="nome_atleta"
              name="nome_atleta" size="50" required></p>
          <p><label for="nascimento_atleta">Data de nascimento do atleta:</label><br><input type="date"
              id="nascimento_atleta" name="nascimento_atleta" required></p>
        </fieldset>
        <fieldset>
          <legend><strong>Compromisso</strong></legend>
          <p>Venho por meio deste firmar o compromisso de garantir a participação do(a) atleta acima mencionado(a) no
            Programa TDF Pro, ofertado pela Trilha do Futebol, na turma que terá início imediatamente após a confirmação
            do pagamento junto ao consultor responsável pela vaga.</p>
          <p><label for="consultor">Nome do consultor de vaga:</label><br><input type="text" id="consultor"
              name="consultor" size="50" required></p>
        </fieldset>
        <section>
          <h3>Declaro estar ciente de que:</h3>
          <ul>
            <li>O acesso ao programa TDF Pro, incluindo os encontros, materiais, grupo exclusivo e bônus, será concedido
              somente após a confirmação do pagamento na data combinada com o consultor da Trilha do Futebol.</li>
            <li>O não cumprimento do pagamento até a data combinada poderá resultar na perda da vaga para a referida
              turma, sem garantia de reposição futura nas mesmas condições.</li>
            <li>Todas as informações relacionadas ao programa, cronograma e condições foram previamente esclarecidas e
              compreendidas no momento da reserva da vaga.</li>
          </ul>
          <p><strong>Trilha do Futebol S.A</strong></p>
        </section>
        <div class="confirmacao">
          <input type="checkbox" id="aceite" name="aceite" required>
          <label for="aceite">Li e concordo com todos os termos e condições apresentados neste documento e confirmo que
            as informações preenchidas são verdadeiras.</label>
        </div>
        <br>
        <button type="button" id="btn-gerar-pdf">Assinar e Gerar PDF</button>
      </form>
    </main>
  </div>

  <div id="modal-overlay">
    <div id="modal">
      <h3>Confirmação</h3>
      <p>Todas as informações preenchidas estão corretas?</p>
      <div class="modal-botoes">
        <button id="modal-cancel-btn">Revisar</button>
        <button id="modal-confirm-btn">Sim, Gerar PDF</button>
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const modalOverlay = document.getElementById('modal-overlay');
      const modalConfirmBtn = document.getElementById('modal-confirm-btn');
      const modalCancelBtn = document.getElementById('modal-cancel-btn');

      const btnGerarPdf = document.getElementById('btn-gerar-pdf');
      btnGerarPdf.addEventListener('click', function () {
        const form = document.getElementById('meu-formulario');
        const requiredInputs = form.querySelectorAll('[required]');
        let isFormValid = true;
        requiredInputs.forEach(input => {
          if ((input.type === 'checkbox' && !input.checked) || (input.type !== 'checkbox' && !input.value)) {
            isFormValid = false;
          }
        });

        if (!isFormValid) {
          alert('Por favor, preencha todos os campos obrigatórios e aceite os termos para continuar.');
          return;
        }
        modalOverlay.classList.add('visible');
      });

      modalCancelBtn.addEventListener('click', () => {
        modalOverlay.classList.remove('visible');
      });

      modalOverlay.addEventListener('click', (event) => {
        if (event.target === modalOverlay) {
          modalOverlay.classList.remove('visible');
        }
      });

      modalConfirmBtn.addEventListener('click', () => {
        modalOverlay.classList.remove('visible');
        gerarPdfNativo();
      });

      function gerarPdfNativo() {
        const nomeResponsavel = document.getElementById('nome_responsavel').value;
        const cpf = document.getElementById('cpf').value;
        const telefone = document.getElementById('telefone').value;
        const nomeAtleta = document.getElementById('nome_atleta').value;
        const nascimentoAtleta = document.getElementById('nascimento_atleta').value;
        const nomeConsultor = document.getElementById('consultor').value;
        const dataFormatada = nascimentoAtleta.split('-').reverse().join('/');

        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF('p', 'mm', 'a4');
        const margin = 20;
        const pageWidth = pdf.internal.pageSize.getWidth();
        let currentY = margin;

        // ==========================================================
        // CÓDIGO DA MARCA D'ÁGUA FOI REMOVIDO DESTA ÁREA
        // ==========================================================

        function addWrappedText(text, options) {
          const lines = pdf.splitTextToSize(text, pageWidth - margin * 2);
          pdf.text(lines, margin, currentY, options);
          currentY += (lines.length * 5) + 3;
        }

        pdf.setFont('helvetica', 'bold');
        pdf.setFontSize(14);
        pdf.text('TERMO DE COMPROMISSO DE PARTICIPAÇÃO E PAGAMENTO', pageWidth / 2, currentY, { align: 'center' });
        currentY += 7;
        pdf.setFontSize(12);
        pdf.text('PROGRAMA TDF PRO – TRILHA DO FUTEBOL', pageWidth / 2, currentY, { align: 'center' });
        currentY += 15;

        pdf.setFont('helvetica', 'normal');
        pdf.setFontSize(11);
        addWrappedText(`Eu, ${nomeResponsavel}, portador(a) do CPF nº ${cpf}, telefone para contato ${telefone}, na qualidade de pai/mãe ou responsável legal pelo(a) atleta:`);
        currentY += 5;

        pdf.setFont('helvetica', 'bold');
        addWrappedText(`Nome completo do atleta: ${nomeAtleta}`);
        addWrappedText(`Data de nascimento do atleta: ${dataFormatada}`);
        currentY += 5;

        pdf.setFont('helvetica', 'normal');
        addWrappedText(`Venho por meio deste firmar o compromisso de garantir a participação do(a) atleta acima mencionado(a) no Programa TDF Pro, ofertado pela Trilha do Futebol, na turma que terá início imediatamente após a confirmação do pagamento junto ao consultor ${nomeConsultor}, responsável pela vaga.`);
        currentY += 5;

        pdf.setFont('helvetica', 'bold');
        addWrappedText('Declaro estar ciente de que:');

        pdf.setFont('helvetica', 'normal');
        addWrappedText('• O acesso ao programa TDF Pro, incluindo os encontros, materiais, grupo exclusivo e bônus, será concedido somente após a confirmação do pagamento na data combinada com o consultor da Trilha do Futebol.');
        addWrappedText('• O não cumprimento do pagamento até a data combinada poderá resultar na perda da vaga para a referida turma, sem garantia de reposição futura nas mesmas condições.');
        addWrappedText('• Todas as informações relacionadas ao programa, cronograma e condições foram previamente esclarecidas e compreendidas no momento da reserva da vaga.');
        currentY += 10;

        const dataAtual = new Date().toLocaleDateString('pt-BR');
        pdf.text(`Curitiba, ${dataAtual}.`, margin, currentY);
        currentY += 25;

        pdf.setFont('helvetica', 'normal');
        pdf.text(nomeResponsavel, margin, currentY);
        currentY += 1;

        pdf.line(margin, currentY, margin + 90, currentY);
        currentY += 5;

        pdf.text('(Responsável Legal)', margin, currentY);

        currentY += 15;
        pdf.setFont('helvetica', 'bold');
        pdf.text('Trilha do Futebol S.A', margin, currentY);


        const nomeArquivo = `Termo_Compromisso_${nomeAtleta.replace(/ /g, '_')}.pdf`;
        pdf.save(nomeArquivo);
      }
    });
  </script>
</body>

</html>